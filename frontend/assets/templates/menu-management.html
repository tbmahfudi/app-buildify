<div id="app-content" class="menu-management-page">
  <!-- Header -->
  <div class="bg-white border-b border-gray-200 px-6 py-4 mb-6">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 flex items-center gap-3">
          <i class="ph-duotone ph-list text-blue-600"></i>
          Menu Management
        </h1>
        <p class="text-sm text-gray-600 mt-1">Manage application menu items and navigation structure</p>
      </div>
      <button id="btn-create-menu" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 shadow-sm">
        <i class="ph-duotone ph-plus-circle"></i>
        <span>Create Menu Item</span>
      </button>
    </div>
  </div>

  <!-- Menu Tree View -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200">
    <div class="p-4 border-b border-gray-200 bg-gray-50">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900">Menu Structure</h2>
        <div class="flex items-center gap-3">
          <button id="btn-expand-all" class="text-sm px-3 py-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition">
            <i class="ph ph-arrows-out"></i> Expand All
          </button>
          <button id="btn-collapse-all" class="text-sm px-3 py-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition">
            <i class="ph ph-arrows-in"></i> Collapse All
          </button>
          <button id="btn-refresh-menu" class="text-sm px-3 py-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded transition">
            <i class="ph ph-arrow-clockwise"></i> Refresh
          </button>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div id="menu-loading" class="p-8 text-center hidden">
      <div class="inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
      <p class="mt-3 text-gray-600">Loading menu items...</p>
    </div>

    <!-- Error State -->
    <div id="menu-error" class="p-8 text-center hidden">
      <i class="ph-duotone ph-warning-circle text-red-500 text-5xl"></i>
      <p class="mt-3 text-red-600 font-medium">Failed to load menu items</p>
      <button onclick="location.reload()" class="mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition">
        <i class="ph ph-arrow-clockwise"></i> Retry
      </button>
    </div>

    <!-- Menu Tree Container -->
    <div id="menu-tree-container" class="p-4">
      <div id="menu-tree" class="space-y-1">
        <!-- Menu items will be rendered here -->
      </div>

      <!-- Empty State -->
      <div id="menu-empty" class="text-center py-12 hidden">
        <i class="ph-duotone ph-folder-open text-gray-300 text-6xl"></i>
        <p class="mt-4 text-gray-500 font-medium">No menu items found</p>
        <p class="text-sm text-gray-400 mt-1">Create your first menu item to get started</p>
        <button class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition inline-flex items-center gap-2">
          <i class="ph ph-plus-circle"></i>
          <span>Create Menu Item</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Create/Edit Menu Item Modal -->
<div id="menu-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
    <!-- Modal Header -->
    <div class="px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-blue-100">
      <div class="flex items-center justify-between">
        <h3 id="modal-title" class="text-xl font-bold text-gray-900">Create Menu Item</h3>
        <button id="btn-close-modal" class="p-2 hover:bg-gray-200 rounded-lg transition">
          <i class="ph ph-x text-xl text-gray-600"></i>
        </button>
      </div>
    </div>

    <!-- Modal Body -->
    <div class="p-6 overflow-y-auto max-h-[calc(90vh-140px)]">
      <form id="menu-form" class="space-y-5">
        <!-- Code -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Code <span class="text-red-500">*</span>
          </label>
          <input type="text" id="input-code" name="code" required
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                 placeholder="e.g., dashboard, settings">
          <p class="text-xs text-gray-500 mt-1">Unique identifier for this menu item (lowercase, no spaces)</p>
        </div>

        <!-- Title -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Title <span class="text-red-500">*</span>
          </label>
          <input type="text" id="input-title" name="title" required
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                 placeholder="e.g., Dashboard">
        </div>

        <!-- Icon -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Icon
          </label>
          <div class="flex gap-2">
            <input type="text" id="input-icon" name="icon"
                   class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   placeholder="e.g., ph-duotone ph-gauge">
            <div id="icon-preview" class="w-12 h-10 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-50">
              <i class="text-2xl text-gray-400"></i>
            </div>
          </div>
          <p class="text-xs text-gray-500 mt-1">
            Phosphor icon class (e.g., ph-duotone ph-gauge)
            <a href="https://phosphoricons.com" target="_blank" class="text-blue-600 hover:underline">Browse icons</a>
          </p>
        </div>

        <!-- Icon Colors (for duo-tone icons) -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Icon Colors (for duo-tone icons)
          </label>
          <div class="flex gap-3">
            <div class="flex-1">
              <label class="block text-xs text-gray-600 mb-1">Primary Color</label>
              <div class="flex gap-2">
                <input type="color" id="input-icon-color-primary" name="icon_color_primary"
                       class="w-12 h-10 border border-gray-300 rounded-lg cursor-pointer"
                       value="#3b82f6">
                <input type="text" id="input-icon-color-primary-text"
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"
                       value="#3b82f6" placeholder="#3b82f6">
              </div>
            </div>
            <div class="flex-1">
              <label class="block text-xs text-gray-600 mb-1">Secondary Color (Opacity)</label>
              <div class="flex gap-2">
                <input type="color" id="input-icon-color-secondary" name="icon_color_secondary"
                       class="w-12 h-10 border border-gray-300 rounded-lg cursor-pointer"
                       value="#93c5fd">
                <input type="text" id="input-icon-color-secondary-text"
                       class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"
                       value="#93c5fd" placeholder="#93c5fd">
              </div>
            </div>
          </div>
          <p class="text-xs text-gray-500 mt-1">Colors apply to duo-tone icons only (ph-duotone)</p>
        </div>

        <!-- Route -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Route
          </label>
          <input type="text" id="input-route" name="route"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                 placeholder="e.g., dashboard (leave empty for parent items)">
          <p class="text-xs text-gray-500 mt-1">Navigation route without # (e.g., "dashboard" â†’ "#/dashboard")</p>
        </div>

        <!-- Parent Menu -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Parent Menu
          </label>
          <select id="input-parent" name="parent_id"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="">None (Top Level)</option>
            <!-- Parent options will be populated dynamically -->
          </select>
        </div>

        <!-- Permission -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Permission
          </label>
          <input type="text" id="input-permission" name="permission"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                 placeholder="e.g., menu:manage:tenant">
          <p class="text-xs text-gray-500 mt-1">Required permission code (optional)</p>
        </div>

        <!-- Required Roles -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Required Roles
          </label>
          <input type="text" id="input-roles" name="required_roles"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                 placeholder='e.g., ["admin", "manager"]'>
          <p class="text-xs text-gray-500 mt-1">JSON array of role codes (optional)</p>
        </div>

        <!-- Description -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Description
          </label>
          <textarea id="input-description" name="description" rows="2"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Optional description"></textarea>
        </div>

        <!-- Order -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Display Order
          </label>
          <input type="number" id="input-order" name="order" value="0"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>

        <!-- Active Status -->
        <div class="flex items-center gap-2">
          <input type="checkbox" id="input-active" name="is_active" checked
                 class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
          <label for="input-active" class="text-sm font-medium text-gray-700">
            Active (visible in menu)
          </label>
        </div>

        <!-- Visible Status -->
        <div class="flex items-center gap-2">
          <input type="checkbox" id="input-visible" name="is_visible" checked
                 class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
          <label for="input-visible" class="text-sm font-medium text-gray-700">
            Visible (show to users)
          </label>
        </div>
      </form>
    </div>

    <!-- Modal Footer -->
    <div class="px-6 py-4 border-t border-gray-200 bg-gray-50 flex items-center justify-end gap-3">
      <button type="button" id="btn-cancel" class="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition">
        Cancel
      </button>
      <button type="submit" form="menu-form" id="btn-save-menu" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2">
        <i class="ph ph-check-circle"></i>
        <span>Save Menu Item</span>
      </button>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
    <div class="p-6">
      <div class="flex items-start gap-4">
        <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0">
          <i class="ph-duotone ph-warning text-red-600 text-2xl"></i>
        </div>
        <div class="flex-1">
          <h3 class="text-lg font-bold text-gray-900">Delete Menu Item?</h3>
          <p class="text-sm text-gray-600 mt-2">Are you sure you want to delete this menu item? This action cannot be undone.</p>
          <p id="delete-menu-name" class="text-sm font-medium text-gray-900 mt-2"></p>
        </div>
      </div>
    </div>
    <div class="px-6 py-4 border-t border-gray-200 bg-gray-50 flex items-center justify-end gap-3">
      <button id="btn-cancel-delete" class="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition">
        Cancel
      </button>
      <button id="btn-confirm-delete" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition flex items-center gap-2">
        <i class="ph ph-trash"></i>
        <span>Delete</span>
      </button>
    </div>
  </div>
</div>
