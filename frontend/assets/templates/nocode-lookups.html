<div class="space-y-6" id="lookups-app">
  <!-- Header -->
  <div class="bg-white border-b border-gray-200 px-6 py-4">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 flex items-center gap-3">
          <i class="ph-duotone ph-list-magnifying-glass text-orange-600"></i>
          Lookup Configuration
        </h1>
        <p class="text-sm text-gray-600 mt-1">Manage lookup tables and reference data</p>
      </div>
      <button onclick="LookupApp.showCreateModal()" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition flex items-center gap-2">
        <i class="ph ph-plus"></i>
        Create Lookup
      </button>
    </div>
  </div>

  <!-- Tabs -->
  <div class="px-6">
    <div class="border-b border-gray-200">
      <nav class="-mb-px flex space-x-8">
        <button onclick="LookupApp.switchTab('lookups')" id="tab-lookups" class="lookup-tab border-b-2 border-orange-600 py-4 px-1 text-sm font-medium text-orange-600">
          Lookup Configurations
        </button>
        <button onclick="LookupApp.switchTab('cascading')" id="tab-cascading" class="lookup-tab border-b-2 border-transparent py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
          Cascading Rules
        </button>
      </nav>
    </div>
  </div>

  <!-- Lookups Tab -->
  <div id="content-lookups" class="px-6">
    <div id="lookups-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Loading state -->
      <div class="col-span-full text-center py-12">
        <i class="ph-duotone ph-spinner text-4xl text-gray-400 animate-spin"></i>
        <p class="text-gray-600 mt-2">Loading lookup configurations...</p>
      </div>
    </div>
  </div>

  <!-- Cascading Rules Tab -->
  <div id="content-cascading" class="px-6 hidden">
    <div class="mb-4 flex justify-end">
      <button onclick="LookupApp.showCreateCascadingModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
        <i class="ph ph-plus"></i> Create Cascading Rule
      </button>
    </div>
    <div class="bg-white rounded-lg shadow-sm overflow-hidden">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rule Name</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Parent Lookup</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Child Lookup</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody id="cascading-tbody" class="bg-white divide-y divide-gray-200">
          <tr>
            <td colspan="5" class="px-6 py-12 text-center text-gray-500">Loading cascading rules...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Create Lookup Modal -->
  <div id="createLookupModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-gray-900">Create Lookup Configuration</h3>
          <button onclick="LookupApp.closeCreateModal()" class="text-gray-400 hover:text-gray-600">
            <i class="ph ph-x text-2xl"></i>
          </button>
        </div>
      </div>

      <form id="createLookupForm" onsubmit="LookupApp.createLookup(event)" class="p-6 space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Configuration Name*</label>
          <input type="text" name="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500" placeholder="e.g., country_lookup">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Display Label*</label>
          <input type="text" name="label" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500" placeholder="e.g., Country Selector">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
          <textarea name="description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500" placeholder="Describe this lookup configuration..."></textarea>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Module</label>
          <select name="module_id" id="lookup_module_select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
            <option value="">-- No Module --</option>
          </select>
          <p class="text-xs text-gray-500 mt-1">Optionally assign this lookup to a module</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Source Type*</label>
          <select name="source_type" required onchange="LookupApp.onSourceTypeChange(this.value)" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
            <option value="entity">Entity (Database Table)</option>
            <option value="static_list">Static List</option>
            <option value="custom_query">Custom Query</option>
            <option value="api">External API</option>
          </select>
        </div>

        <!-- Entity Source Fields -->
        <div id="entity-fields" class="source-type-fields space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Source Entity*</label>
            <select name="source_entity_id" id="source_entity_select" onchange="LookupApp.onEntityChange(this.value)" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="">-- Select Entity --</option>
            </select>
            <p class="text-xs text-gray-500 mt-1">Select the entity to load lookup data from</p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Display Field*</label>
            <select name="display_field" id="display_field_select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="">-- Select Entity First --</option>
            </select>
            <p class="text-xs text-gray-500 mt-1">Field shown to users in the dropdown</p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Value Field*</label>
            <select name="value_field" id="value_field_select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="">-- Select Entity First --</option>
            </select>
            <p class="text-xs text-gray-500 mt-1">Field stored when option is selected (usually id)</p>
          </div>
        </div>

        <!-- Static List Fields -->
        <div id="static-list-fields" class="source-type-fields space-y-4 hidden">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Static Options (JSON)*</label>
            <textarea name="static_options" rows="8" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-sm" placeholder='[
  { "value": "low", "label": "Low", "color": "#10b981" },
  { "value": "medium", "label": "Medium", "color": "#f59e0b" },
  { "value": "high", "label": "High", "color": "#ef4444" }
]'></textarea>
            <p class="text-xs text-gray-500 mt-1">Enter JSON array of options. Each option must have "value" and "label". Optional: "color", "icon", "metadata"</p>
          </div>
        </div>

        <!-- Custom Query Fields -->
        <div id="custom-query-fields" class="source-type-fields space-y-4 hidden">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">SQL Query*</label>
            <textarea name="custom_query" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-sm" placeholder="SELECT id AS value, name AS label FROM categories WHERE is_active = true ORDER BY name"></textarea>
            <p class="text-xs text-gray-500 mt-1">Query must return "value" and "label" columns. Use "AS" to rename columns.</p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Query Parameters (JSON)</label>
            <textarea name="query_parameters" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-sm" placeholder='{ "status": "active" }'></textarea>
          </div>
        </div>

        <!-- API Fields -->
        <div id="api-fields" class="source-type-fields space-y-4 hidden">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">API Endpoint*</label>
            <input type="text" name="api_endpoint" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500" placeholder="https://api.example.com/options">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">HTTP Method</label>
            <select name="api_method" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="GET">GET</option>
              <option value="POST">POST</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Headers (JSON)</label>
            <textarea name="api_headers" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-sm" placeholder='{ "Authorization": "Bearer token" }'></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Response Mapping (JSON)</label>
            <textarea name="api_response_mapping" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 font-mono text-sm" placeholder='{ "data_path": "results", "value_field": "id", "label_field": "name" }'></textarea>
            <p class="text-xs text-gray-500 mt-1">Map API response fields to lookup value and label</p>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <input type="checkbox" name="enable_search" checked class="mr-2">
              Enable Search
            </label>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <input type="checkbox" name="enable_caching" checked class="mr-2">
              Enable Caching
            </label>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4">
          <button type="button" onclick="LookupApp.closeCreateModal()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
            Cancel
          </button>
          <button type="submit" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
            Create Lookup
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- View Lookup Detail Modal -->
  <div id="viewLookupModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-gray-900" id="viewLookupTitle">Lookup Details</h3>
          <button onclick="LookupApp.closeViewModal()" class="text-gray-400 hover:text-gray-600">
            <i class="ph ph-x text-2xl"></i>
          </button>
        </div>
      </div>

      <div id="viewLookupContent" class="p-6">
        <!-- Content will be loaded dynamically -->
      </div>
    </div>
  </div>

  <!-- Edit Lookup Modal -->
  <div id="editLookupModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-gray-900">Edit Lookup Configuration</h3>
          <button onclick="LookupApp.closeEditModal()" class="text-gray-400 hover:text-gray-600">
            <i class="ph ph-x text-2xl"></i>
          </button>
        </div>
      </div>

      <form id="editLookupForm" onsubmit="LookupApp.saveLookupEdit(event)" class="p-6 space-y-4">
        <input type="hidden" name="edit_lookup_id" id="edit_lookup_id">

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Display Label*</label>
          <input type="text" name="label" id="edit_lookup_label" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
          <textarea name="description" id="edit_lookup_description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"></textarea>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Module</label>
          <select name="module_id" id="edit_lookup_module_select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
            <option value="">-- No Module --</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Display Field</label>
          <input type="text" name="display_field" id="edit_lookup_display_field" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Value Field</label>
          <input type="text" name="value_field" id="edit_lookup_value_field" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Placeholder Text</label>
          <input type="text" name="placeholder_text" id="edit_lookup_placeholder" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <input type="checkbox" name="enable_search" id="edit_lookup_search" class="mr-2">
              Enable Search
            </label>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <input type="checkbox" name="enable_caching" id="edit_lookup_caching" class="mr-2">
              Enable Caching
            </label>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Cache TTL (seconds)</label>
          <input type="number" name="cache_ttl_seconds" id="edit_lookup_cache_ttl" min="0" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <input type="checkbox" name="is_active" id="edit_lookup_active" class="mr-2">
            Active
          </label>
        </div>

        <div class="flex justify-end gap-3 pt-4">
          <button type="button" onclick="LookupApp.closeEditModal()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
            Cancel
          </button>
          <button type="submit" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
            Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
